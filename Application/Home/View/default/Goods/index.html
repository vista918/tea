<extend name="Base/common"/>

<block name="stylex">
<!--jQuery dependencies
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/themes/base/jquery-ui.css" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>    
    <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.2/jquery-ui.min.js"></script>-->
	<link rel="stylesheet" href="__STATIC__/jquery-ui.css" />
    <!--<script src="__STATIC__/jquery.min.js"></script>    -->
    <script src="__STATIC__/jquery-ui.min.js"></script>
	
    <link href="__STATIC__/grid-2.0.4/pqgrid.min.css" type="text/css" rel="stylesheet"/>
<!--PQ Grid Office theme-->
    <link rel="stylesheet" href="__STATIC__/grid-2.0.4/themes/office/pqgrid.css" />
	
    <script src="__STATIC__/grid-2.0.4/pqgrid.min.js"></script>
</block>
	
<block name="script">
    <script type="text/javascript">	  
	// 对Date的扩展，将 Date 转化为指定格式的String
	// 月(M)、日(d)、小时(h)、分(m)、秒(s)、季度(q) 可以用 1-2 个占位符， 
	// 年(y)可以用 1-4 个占位符，毫秒(S)只能用 1 个占位符(是 1-3 位的数字) 
	// 例子： 
	// (new Date()).Format("yyyy-MM-dd hh:mm:ss.S") ==> 2006-07-02 08:09:04.423 
	// (new Date()).Format("yyyy-M-d h:m:s.S")      ==> 2006-7-2 8:9:4.18 
	Date.prototype.format = function (fmt) { //author: meizz 
		var o = {
			"M+": this.getMonth() + 1, //月份 
			"d+": this.getDate(), //日 
			"h+": this.getHours(), //小时 
			"m+": this.getMinutes(), //分 
			"s+": this.getSeconds(), //秒 
			"q+": Math.floor((this.getMonth() + 3) / 3), //季度 
			"S": this.getMilliseconds() //毫秒 
		};
		if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
		for (var k in o)
		if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
		return fmt;
	}
	
    $(function () {
		//document.write({$totalgoods[3]['goodsid']});
		var datafromcontroller = <?php echo json_encode($totalgoods)?>;
		//console.trace(datafromcontroller.length);
		var countofgoods = datafromcontroller.length;// count({$totalgoods});
		var data = new Array(countofgoods);
		var statusStr = ['已上架','待下架','已下架'];
		for(i = 0 ; i < countofgoods; ++i)
		{
			data[i] = new Array();			
			data[i][0] = datafromcontroller[i].goodsid;
			data[i][1] = datafromcontroller[i].name;
			data[i][2] = datafromcontroller[i].curprice;
			data[i][3] = datafromcontroller[i].stock;
			data[i][4] = datafromcontroller[i].sales;
			var newDate = new Date();
			newDate.setTime(datafromcontroller[i].createtime*1000);
			data[i][5] = newDate.format('yyyy-MM-dd hh:mm:ss');
			data[i][6] = statusStr[datafromcontroller[i].status];//验证阶段需要在数据库插入的时候做
			data[i][7] = datafromcontroller[i].priority;
			data[i][8] = 0;
		}
		//data[0].push(1, 'Exxon Mobil', '339,938.0', '36,130.0');
		//data[1] = new array();
		//data[1] = [1, 'Exxon Mobil', '339,938.0', '36,130.0'];
        //var data = [[1, 'Exxon Mobil', '339,938.0', '36,130.0'],
        //    [2, 'Wal-Mart Stores', '315,654.0', '11,231.0']];

        var obj = { 
			width: 1000,
			height: 600,
			title: "商品列表",
			resizable:false,
			draggable:false 
		};
		
        obj.colModel = 
		[
			{ title: "商品编号", width: 80, dataType: "integer" },
			{ title: "商品名称", width: 120, dataType: "string" },
			{ title: "销售价(￥)", width: 100, dataType: "float", align: "right" },
			{ title: "库存", width: 80, dataType: "float", align: "right"},
			{ title: "销量", width: 80, dataType: "float", align: "right" },
			{ title: "上架时间", width: 160, dataType: "string", align: "right"},
			{ title: "商品状态", width: 80, dataType: "float", align: "right" },
			{ title: "优先级", width: 80, dataType: "float", align: "right"},
			{ title: "操作", width: 150, dataType: "float", align: "right"}
		];
        obj.dataModel = { data: data };
        $("#grid_array").pqGrid(obj);

    });   
    </script>
</block>

<block name="style">	
	<style type="text/css">	
	.concss {
	  position:absolute;
	  left:495px;
	  top:80px;
	  width:700px;
	  height:300px;
	}
	.concss2 {
	  position:absolute;
	  left:495px;
	  top:422px;
	  width:700px;
	  height:300px;
	}
	.gridcss {
	  position:absolute;
	  left:100px;
	  top:40px;
	}
	</style>
</block>

<block name="side">
<!-- 左侧 nav
==================================================
    <div class="span3 bs-docs-sidebar">
        <ul class="nav nav-list bs-docs-sidenav">
            {:W('Category/lists', array(1, true))}
        </ul>
    </div> -->
</block>

<block name="body">   	
	<div id="grid_array" class = "gridcss" ></div>   
</block>
